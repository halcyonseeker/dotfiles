#!/bin/sh
# Send notifications when my battery gets low
# Dependencies: libnotify, dunst

# The calmest WM setup is cwm without a statusbar, but I'm paranoid
# about my laptop's battery getting too low. This script will send
# notifications at every 5% drop after the battery drops below the 30%
# mark.
# Run this file from your WM/Xorg startup file.

# TODO: make work with battery-less systems and OpenBSD's apm

# Loop 4 ever
while true ; do

    # Get battery status
    bat_stat="$(cat /sys/class/power_supply/BAT0/capacity)"

    # Check if battery â‰¤ 30%
    if [ "$bat_stat" -le 30 ] ; then

	# Check if battery â‰¤ 10%
	if [ "$bat_stat" -le 10 ] ; then
	    notify-send -t 2000 -u critical âš "BAT: $bat_stat"
	else
	    notify-send -t 2000 -u normal ðŸ”‹"BAT: $bat_stat"
	fi
    fi

    # Don't be a resource hog
    sleep 5m
done

    
