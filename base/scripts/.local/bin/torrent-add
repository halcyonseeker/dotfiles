#!/bin/sh
# Default handler for magnet links
# Called by ~/.local/share/applications/torrent.desktop and ~/.config/mimeapps.list
# Depends on transmission-cli, notify-send, and dunst

if [ -z "$1" ] ; then
    notify-send "ğŸŒ± Torrent Handler" "Failed: Command Line Empty"
    exit 1
fi

pgrep -x transmission-da >/dev/null || \
    (transmission-daemon && notify-send "ğŸŒ± Torrent Handler" "Starting transmission-daemon...")

sleep 5

if (transmission-remote -a "$1" >"$HOME"/torrent-add.err 2>&1) ; then 
    notify-send "ğŸŒ± Torrent Handler" "Added $1"
else
    notify-send "ğŸŒ± Torrent Handler" "Failed: Unable to Add Torrent. See ~/torrent-add.err"
fi
