#!/bin/sh
# Poll my battery and send notifications when it gets low.
# Dependencies: libnotify, dunst

set -eu

while true; do
	if [ $(uname) = "OpenBSD" ]; then
		bat_stat="$(apm | head -1 | cut -d ' ' -f4 | tr -d '%')"
	else 
		bat_stat="$(cat /sys/class/power_supply/BAT0/capacity)" 
	fi

	[ "$bat_stat" -le 30 ] && {
		if [ "$bat_stat" -le 10 ]; then
	    		notify-send -t 2000 -u critical âš "BAT: $bat_stat"
		else
	    		notify-send -t 2000 -u normal ðŸ”‹"BAT: $bat_stat"
		fi
	}

	sleep 300
done

    
